import{_ as s,W as a,X as e,a0 as t,Y as n,Z as p,a2 as o}from"./framework-3ac60b7d.js";const c={},l=n("h1",{id:"java-aes-加密-解密",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#java-aes-加密-解密","aria-hidden":"true"},"#"),p(" java aes 加密/解密")],-1),u=o(`<p>aes 对key的长度有要求 下面是key填充方法</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>fun <span class="token function">fillKey</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">ByteArray</span> <span class="token punctuation">{</span>
    val random <span class="token operator">=</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;SHA1PRNG&quot;</span><span class="token punctuation">)</span>
    random<span class="token punctuation">.</span><span class="token function">setSeed</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    val generator <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span>
    generator<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>random<span class="token punctuation">)</span>
    <span class="token keyword">return</span> generator<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encoded
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基于hutool封装的工具类</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
fun <span class="token function">ktAes</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> source<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    val keyBytes <span class="token operator">=</span> <span class="token function">fillKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token class-name">SecureUtil</span><span class="token punctuation">.</span><span class="token function">aes</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encryptBase64</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

fun <span class="token function">ktDeAes</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> source<span class="token operator">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    val keyBytes <span class="token operator">=</span> <span class="token function">fillKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token class-name">SecureUtil</span><span class="token punctuation">.</span><span class="token function">aes</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decryptStr</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4);function i(r,k){return a(),e("div",null,[l,t(" more "),u])}const v=s(c,[["render",i],["__file","java_aes.html.vue"]]);export{v as default};
